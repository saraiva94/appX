<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Teste IPC</title>
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; img-src 'self' data:">
</head>
<body>
  <h1>Teste IPC</h1>
  <div id="log"></div>
  <script>
    const logEl = document.getElementById('log');
    
    function log(msg) {
      const div = document.createElement('div');
      div.textContent = msg;
      logEl.appendChild(div);
      console.log(msg);
    }
    
    log('Registrando onShot handler...');
    try {
      window.bridge.onShot((data) => {
        log(`Renderer: recebeu data id=${data?.id} len=${data?.b64?.length || 0}`);
        try {
          window.bridge.sendStatus(`Renderer: processou data id=${data?.id}`);
        } catch (e) {
          log('Renderer: erro ao enviar status: ' + e);
        }
      });
      log('Handler registrado com sucesso');
    } catch (e) {
      log('Erro ao registrar handler: ' + e);
    }
  </script>
</body>
</html>